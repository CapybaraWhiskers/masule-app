{% extends 'base.html' %}
{% block title %}トレーニング履歴{% endblock %}
{% block content %}
<h1>トレーニング履歴</h1>
<!-- 記録追加用モーダルを開くボタン -->
<button type="button" id="openLogModal">記録</button>

<!-- 表示フィルター -->
<label for="muscleFilter">部位フィルター:</label>
<select id="muscleFilter">
  <option value="">全て</option>
  <option value="胸">胸</option>
  <option value="背中">背中</option>
  <option value="脚">脚</option>
  <option value="肩">肩</option>
  <option value="腕">腕</option>
  <option value="腹">腹</option>
</select>
<label for="exerciseFilter">種目フィルター:</label>
<select id="exerciseFilter">
  <option value="">全て</option>
  {% for ex in exercises %}
    <option value="{{ ex.name }}">{{ ex.name }}</option>
  {% endfor %}
</select>

{% if workouts %}
<!-- ログがある場合はテーブル表示 -->
<table id="workoutTable">
  <thead>
    <tr>
      <th>日付</th>
      <th>種目</th>
      <th>部位</th>
      <th>セット</th>
      <th>回数</th>
      <th>重量(kg)</th>
      <th>強度</th>
      <th>操作</th>
    </tr>
  </thead>
  <tbody>
  {% for w in workouts %}
  <!-- 行の色を部位ごとに変更 -->
  <tr class="data-row {% if w.muscle_group == '胸' %}bg-chest{% elif w.muscle_group == '背中' %}bg-back{% elif w.muscle_group == '脚' %}bg-legs{% elif w.muscle_group == '肩' %}bg-shoulders{% elif w.muscle_group == '腕' %}bg-arms{% elif w.muscle_group == '腹' %}bg-core{% else %}bg-default{% endif %}" data-muscle="{{ w.muscle_group }}" data-exercise="{{ w.exercise }}">
    <td>{{ w.date_short }}</td>
    <td><a href="#" class="exercise-filter-link">{{ w.exercise }}</a></td>
    <td>{{ w.muscle_group }}</td>
    <td>{{ w.sets }}</td>
    <td>{{ w.reps }}</td>
    <td>{{ w.weight }}</td>
    <td>{{ w.intensity }}</td>
      <td>
        <!-- 編集ボタンはモーダルでフォームを開く -->
        <a href="#" class="button-link edit-workout" data-id="{{ w.id }}">編集</a>
        <form method="post" action="{{ url_for('delete_workout', wid=w.id) }}" style="display:inline">
          <button type="submit" onclick="return confirm('本当にこのログを削除しますか？')">削除</button>
        </form>
      </td>
  </tr>
  {% endfor %}
</tbody>
</table>
{% else %}
<!-- ログが無い場合のメッセージ -->
<p>まだログがありません。記録ボタンから追加しましょう。</p>
{% endif %}

{% endblock %}
