{% extends 'base.html' %}
{% block title %}エクササイズ管理{% endblock %}
{% block content %}
<h1>エクササイズ管理</h1>
<h2><button type="button" id="toggleForm">新しいエクササイズを追加</button></h2>
<div id="exerciseForm" style="display:none;">
  <form method="post">
    名前：<input type="text" name="name" required>
    部位：
    <select name="muscle_group">
      <option>胸</option>
      <option>背中</option>
      <option>脚</option>
      <option>肩</option>
      <option>腕</option>
      <option>腹</option>
    </select>
    メモ：<input type="text" name="memo">
    動画URL：<input type="url" name="video_url">
    セット数デフォルト：<input type="number" name="default_sets" min="1">
    回数デフォルト：<input type="number" name="default_reps" min="1">
    重量デフォルト(kg)：<input type="number" name="default_weight" step="0.1">
    <button type="submit">追加</button>
    <button type="button" id="cancelAdd">キャンセル</button>
  </form>
</div>

<form method="get" style="margin-top: 10px;">
  並び順：
  <select name="sort">
    <option value="new" {% if sort == 'new' %}selected{% endif %}>新しい順</option>
    <option value="old" {% if sort == 'old' %}selected{% endif %}>古い順</option>
  </select>
  部位フィルター：
  <select name="muscle">
    <option value="" {% if not muscle %}selected{% endif %}>全て</option>
    <option value="胸" {% if muscle == '胸' %}selected{% endif %}>胸</option>
    <option value="背中" {% if muscle == '背中' %}selected{% endif %}>背中</option>
    <option value="脚" {% if muscle == '脚' %}selected{% endif %}>脚</option>
    <option value="肩" {% if muscle == '肩' %}selected{% endif %}>肩</option>
    <option value="腕" {% if muscle == '腕' %}selected{% endif %}>腕</option>
    <option value="腹" {% if muscle == '腹' %}selected{% endif %}>腹</option>
  </select>
  <button type="submit">適用</button>
</form>

<table>
  <tr>
    <th>番号</th>
    <th>名前</th>
    <th>部位</th>
    <th>操作</th>
  </tr>
  {% for e in exercises %}
  <tr>
    <td>{{ numbers[e.id] }}</td>
    <td><a href="#" class="exercise-note" data-memo="{{ e.memo|default('') }}" data-video="{{ e.video_url|default('') }}">{{ e.name }}</a></td>
    <td>{{ e.muscle_group }}</td>
    <td>
      <a href="#" data-id="{{ e.id }}" class="button-link edit-exercise">編集</a>
      <form method="post" style="display:inline">
        <input type="hidden" name="delete_id" value="{{ e.id }}">
        <button type="submit" onclick="return confirm('本当にこの種目を削除しますか？')">削除</button>
      </form>
    </td>
  </tr>
  {% endfor %}
</table>
{% endblock %}
